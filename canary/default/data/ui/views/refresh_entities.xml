<!-- Copyright (C) 2010-2019 Sideview LLC.  All Rights Reserved. -->
<view isVisible="false" template="dashboard.html">
  <label>the FreshMaker</label>

  <module name="SideviewUtils" layoutPanel="appHeader" />

  <module name="HTML" layoutPanel="viewHeader">
    <param name="html"><![CDATA[
    <h1>Canary - the FreshMaker 2.0</h1>
    ]]></param>
  </module>

  <module name="URLLoader" layoutPanel="panel_row1_col1">
    <!-- <module name="Search">
      <param name="search">
        | rest /servicesNS/-/-/admin
        | eval path=split(replace(id, "http(s)?://",""), "/")
        | eval path=mvindex(path, 5)
      </param>
    -->
    <module name="Search">
      <param name="search">
| makeresults
| fields - _time
| eval path=split("data/ui/views,data/ui/nav,admin/conf-times,data/ui/manager,admin/MonitorNoHandle,admin/WinEventLog,admin/WinHostMon,admin/WinNetMon,admin/WinPrintMon,admin/WinRegMon,admin/alert_actions,admin/applicense,admin/clusterconfig,admin/collections-conf,admin/commandsconf,admin/conf-checklist,admin/conf-deploymentclient,admin/conf-inputs,admin/conf-times,admin/conf-wmi,admin/cooked,admin/crl,admin/datamodel-files,admin/datamodelacceleration,admin/datamodeledit,admin/dataset_consolidation_datamodeleditOK,admin/deploymentserver,admin/distsearch-peer,admin/eventtypes,admin/fields,admin/fvtags,admin/ga,admin/http,admin/indexer-discovery-configOK,admin/indexes,admin/limits,admin/livetail,admin/localapps,admin/lookup-table-files,admin/macros,admin/manager,admin/messages-conf,admin/metrics-reload,admin/modalerts,admin/monitor,admin/nav,admin/panels,admin/passwords,admin/pools,admin/powershell,admin/powershell2,admin/proxysettings,admin/quickstart,admin/raw,admin/remote_eventlogs,admin/remote_indexes,admin/remote_monitor,admin/remote_perfmon,admin/remote_raw,admin/remote_script,admin/remote_udp,admin/savedsearch,admin/scheduledviews,admin/script,admin/search-head-bundles,admin/serverclasses,admin/shclusterconfig,admin/sourcetypes,admin/splunktcptoken,admin/ssl,admin/syslog,admin/tcpout-default,admin/tcpout-group,admin/tcpout-server,admin/telemetry,admin/transforms-extract,admin/transforms-lookup,admin/transforms-reload,admin/transforms-statsd,admin/udp,admin/ui-prefs,admin/ui-tour,admin/views,admin/viewstates,admin/visualizations,admin/vix-indexes,admin/vix-providers,admin/win-admon,admin/win-event-log-collectionsOK,admin/win-eventlogs,admin/win-perfmon,admin/win-regmon,admin/win-wmi-collections,admin/workflow-actions", ",")
| mvexpand path
| eval label=case(path="/data/ui/views","views",path="/data/ui/nav/","nav",true(),path)
      </param>

      <module name="Pulldown">
        <param name="name">entity</param>
        <param name="label">1. Choose something to refresh</param>
        <param name="float">left</param>
        <param name="valueField">path</param>
        <param name="labelField">label</param>
        <param name="staticOptions"></param>

        <module name="Button">
          <param name="allowSoftSubmit">True</param>
          <param name="label">Refresh</param>

          <module name="ValueSetter">
            <param name="name">encodedEntity</param>
            <param name="urlEncodeKeys">entity</param>
            <param name="value">$entity$</param>

            <module name="HTML" layoutPanel="panel_row1_col2">
              <param name="html"><![CDATA[
                <iframe id="theFreshMaker" name="theFreshMaker" src="../../../../../custom/sideview_utils/freshmaker/refresh?entityPath=$entity$" height="1000px" width="100%" style="border:0px;"></iframe>
              ]]></param>
            </module>
          </module>
        </module>
      </module>

      <module name="HTML">
        <param name="html"><![CDATA[
          <p>2. Or if you prefer to click links you can do that.</p>
        ]]></param>
      </module>

      <module name="Multiplexer" layoutPanel="panel_row1_col1">
        <param name="fields">path,label</param>

        <module name="Link">
          <param name="label">$label$</param>

          <module name="Redirector">
            <param name="url">../../../../../custom/sideview_utils/freshmaker/refresh</param>
            <param name="target">theFreshMaker</param>
            <param name="arg.entityPath">$path$</param>
          </module>
        </module>
      </module>
    </module>
  </module>

  <module name="HTML" layoutPanel="panel_row2_col1">
    <param name="html"><![CDATA[
      <h3>The Bump Endpoint</h3>
      <p>
        <a href="/en-US/_bump">/en-US/_bump</a>  <br>
        Click this after changing any files in /appserver/static or /appserver/modules. <br>
        If you don't click this at such times then Splunk's aggressive cacheing on static files<br>
        will cause problems in your deployment. Specifically, other users of this Splunk instance<br>
        may continue to see the out-of-date versions previously cached by their browsers.
      </p>

      <p>
        Ah. So refreshing.
      </p>
      <p>
        If you have no idea what you're looking at,  this is a tool to make it slightly easier to refresh Splunk entities while you're developing your splunk apps.   If you don't know what that means, that's ok;  it's probably not your cup of tea anyway.
      </p>

    ]]></param>
  </module>

</view>
