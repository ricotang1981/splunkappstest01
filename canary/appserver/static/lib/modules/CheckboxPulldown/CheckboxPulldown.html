<% 
# Copyright (C) 2010-2019 Sideview LLC.  All Rights Reserved.
    def isPopulated(pName, module) :
        if (pName in module and module[pName]) :
            return True
        else:
            return False
%>
<%page args="module"/>
<%def name="buildOption(label, value='', selected='False')"><% 
    selectedAttr = ('selected="selected"') if selected.lower() == "true" else '' 
    if (value==None): value=""
    if (label==None): label=value
    %><option ${selectedAttr} value="${value | h}">${label | h}</option></%def>\

## if the label begins and ends with $, we do $foo$ substitution, 
## straight from the URL
<%def name="buildLabel(module)">\
    <%
    staticLabel  = _(module.get('label', ''))
    %>
    % if len(staticLabel)>2 and staticLabel[0]=="$" and staticLabel[-1]=="$" :
        <label for="${module['moduleId']}_select">${qs.get(staticLabel[1:-1],"") | h}</label>
    % elif (len(staticLabel)>0) :
        <label for="${module['moduleId']}_select">${staticLabel|h}</label>
    % endif
</%def>
        <div class="progressTop"></div>
        <%self:buildLabel module="${module}" />
        <select id="${module['moduleId']}_select" multiple="multiple" size="1"
% if module.get("width",False): 
            style="width:${module['width']|h}" 
% endif
        ><%
    if (isPopulated("staticOptions",module)):
        staticOptionsParam = "staticOptions"
    elif (isPopulated("staticFieldsToDisplay", module)):
        staticOptionsParam = "staticFieldsToDisplay"
    else: 
        staticOptionsParam = False
%>    
% if (staticOptionsParam) :
    % for field in module[staticOptionsParam]:
        % if field and field.get('value', False)!=False :
    <%self:buildOption label="${field.get('label')}" value="${field.get('value','')}" selected="${field.get('selected', 'False')}" />
        % else :
    <option> Pulldown.html - VIEW CONFIGURATION ERROR - you have specified a &lt;list&gt; element with no &lt;value&gt; element</option>
        % endif
    % endfor
% endif

%if (isPopulated("searchFieldsToDisplay",module) or isPopulated("valueField",module)):
    <option class="dynamic" value="">${_("Loading...")|h}</option>
% endif

</select>


